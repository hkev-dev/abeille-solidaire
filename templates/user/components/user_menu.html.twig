{% import "user/components/menu-item.html.twig" as menuItem %}

<div {{ attributes }}>
	<div
		class="menu flex flex-col w-full gap-1.5 px-3.5" data-menu="true" data-menu-accordion-expand-all="false" id="sidebar_primary_menu">
		{# Dashboard #}
		{{ menuItem.render({
            label: 'Tableau de bord',
            icon: 'ki-duotone ki-element-11',
            route: 'app.user.dashboard'
        }) }}

		{# Current Flower Section with donation progress #}
		{{ menuItem.render({
            label: 'Ma Fleur Actuelle',
            icon: 'ki-duotone ki-abstract-26',
            route: 'app.user.flower.current',
            badge: {
                text: flowerProgress.received ~ '/4',
                class: flowerProgress.received == 4 ? 'badge-success' : 'badge-info'
            }
        }) }}

		{# Donations Management #}
		{{ menuItem.render({
            label: 'Dons',
            icon: 'ki-duotone ki-heart',
            routes: ['app.user.donations.received', 'app.user.donations.sent', 'app.user.donations.solidarity'],
            submenu: [
                {
                    label: 'Dons Reçus',
                    route: 'app.user.donations.received',
                    badge: unreadDonationsCount > 0 ? {
                        text: unreadDonationsCount,
                        class: 'badge-success'
                    } : null
                },
                {
                    label: 'Dons Envoyés',
                    route: 'app.user.donations.sent'
                },
                {
                    label: 'Dons Solidaires',
                    route: 'app.user.donations.solidarity'
                }
            ]
        }) }}

		{# Wallet & Withdrawals #}
		{{ menuItem.render({
            label: 'Portefeuille',
            icon: 'ki-duotone ki-wallet',
            routes: ['app.user.wallet.index', 'app.user.wallet.withdraw', 'app.user.wallet.history'],
            submenu: [
                {
                    label: 'Solde',
                    route: 'app.user.wallet.index',
                    badge: {
                        text: '€ ' ~ walletBalance|number_format(2, ',', ' '),
                        class: 'badge-primary'
                    }
                },
                {
                    label: 'Retrait',
                    route: 'app.user.wallet.withdraw'
                },
                {
                    label: 'Historique',
                    route: 'app.user.wallet.history'
                }
            ]
        }) }}

		{# Project Management #}
		{{ menuItem.render({
            label: 'Mon Projet',
            icon: 'ki-duotone ki-rocket',
            submenu: [
                {
                    label: 'Présentation'
                },
                {
                    label: 'Story'
                },
                {
                    label: 'Actualités'
                },
                {
                    label: 'Questions/Réponses'
                },
                {
                    label: 'Témoignages'
                }
            ]
        }) }}

		{# Flower Progress #}
		{{ menuItem.render({
            label: 'Progression',
            icon: 'ki-duotone ki-chart-line',
            submenu: [
                {
                    label: 'Matrice Actuelle'
                },
                {
                    label: 'Cycles Complétés',
                    badge: completedCycles > 0 ? {
                        text: completedCycles,
                        class: 'badge-success'
                    } : null
                },
                {
                    label: 'Prochaine Fleur'
                }
            ]
        }) }}

		{# Referral System Section #}
		{{ menuItem.render({
            label: 'Parrainage',
            icon: 'ki-duotone ki-people',
            routes: ['app.user.referral.referrals', 'app.user.referral.link', 'app.user.referral.stats'],
            submenu: [
                {
                    label: 'Mes Filleuls',
                    route: 'app.user.referral.referrals',
                    badge: {
                        text: referralCount ~ '/4',
                        class: referralCount >= 4 ? 'badge-success' : (referralCount > 0 ? 'badge-primary' : 'badge-light')
                    }
                },
                {
                    label: 'Lien de Parrainage',
                    route: 'app.user.referral.link'
                },
                {
                    label: 'Statistiques',
                    route: 'app.user.referral.stats'
                }
            ]
        }) }}

		{# Settings & Profile #}
		{{ menuItem.render({
            label: 'Paramètres',
            icon: 'ki-duotone ki-setting-2',
            submenu: [
                {
                    label: 'KYC Vérification',
                    badge: not kycStatus ? {
                        text: 'Requis',
                        class: 'badge-warning'
                    } : null
                },
                {
                    label: 'Méthodes de Paiement'
                },
                {
                    label: 'Adhésion Annuelle',
                    badge: not currentMembership ? {
                        text: 'À renouveler',
                        class: 'badge-danger'
                    } : null
                }
            ]
        }) }}
	</div>
</div>
